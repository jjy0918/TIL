# 정규 표현식

## 정규 표현식이란?

- 정규 표현식이란 문자열을 일정한 패턴으로 파악하는 방법.
- 보통 RegEx, RegExp 라고 칭한다.
- 유닉스 계열의 명령어(grep, awk 등)에서 자주 사용된다.
- 정규 표현식은 하나의 확고한 문법이 아니기 때문에 운영체제마다, 사용하는 언어마다, 엔진마다 문법이 조금씩 다르기 때문에 주의가 필요하다.

## 정규 표현식 문법

### 메타 문자

- 정규표현식에서 이미 정의되어 있는 문자들을 메타 문자라고 한다.
- 메타 문자는 기본적으로 특별한 의미를 가지고 있다.
  - 메타 문자는 하나의 특수 문자거나 역슬래시(\)를 포함한 단일 문자가 된다.
- `^`는 문자열의 시작을 의미한다.
- `&`는 문자열의 끝을 의미한다.

### 지정된 검사 범위

- 알파벳 메타 문자를 대문자로 변경할 경우 역을 의미한다.
  - `\w`의 경우 알파벳 or 대소문자이지만 `\W`의 경우 알파벳 or 대소문자가 아닌 모든 문자를 의미한다.
- `.`: 모든 문자를 의미한다.
- `\t`: 탭 문자를 의미한다.
- `\n`: 개행 문자를 의미한다.
- `\b`: 문자와 공백 사이를 의미한다.(진짜 공백)
- `\s`: 탭(\t), 줄 바꿈 문자(\n) 를 의미한다. 즉, 공백 문자를 의미한다.
  - `\s`는 `\t`와 `\n`, `\b`를 포함한다.
- `\w`: 숫자, 알파벳 대소문자 혹은 언더바(_) 하나를 의미한다.
- `\d`: 모든 숫자를 하나를 의미한다.
- `\0`: 8진수 값을 의미한다.
- `\x`: 16진수 값을 의미한다.

### 범위 검사

- `[`와 `]` 사이의 메타 문자 혹은 일반 문자를 통해 집합을 표현할 수 있다.
  - `[ABC]`: A라는 문자 또는 B라는 문자 또는 C라는 문자가 포함되어 있음을 나타낸다.
  - `^`을 통해 역을 나타낼 수 있다.
    - `[^ABC]`: 문자 A, B, C 가 아닌 문자를 의미한다. 즉 D, E, F, 1, ㅁ 등
  - `-`을 통해 범위를 지정할 수 있다.
    - `[A-D]`: A와 D사이의 문자를 나타낸다. 즉, A, B, C, D
    - 기본적으로 범위는 작은 값 - 큰 값으로 나타내야 한다.


### 그룹화

- `(` 와 `)` 사이의 문자 자체가 정확히 일치하는지 표현할 수 있다.
  - `(asd)`: 문자가 asd인지 판단한다.
- 그룹화 비캡처
  - `(?:)`: 해당 형태는 기본적으로 `()`와 동일하지만, 캡처하지 않는다.
  - `(?=)`: 해당 형태는 ?= 뒤에 오는 문자열의 앞만 판단한다.
  - `(?<=)`: 해당 형태는 ?<= 뒤에 오는 문자열을 뒤만 판단한다.


### 수량 검사

- `{n}`: 정확히 n번 반복될 때 사용한다.
- `{n,}`: n번 이상 반복될 때 사용한다.
- `{n, m}`: n~m 번 사이 만큼 반복될 때 사용한다.
- `*`: 패턴이 0번 이상 일치할 때 사용한다.`{0,}` 와 같은 의미를 가진다.
- `+`: 패턴이 1번 이상 일치할 때 사용한다. `{1,}` 와 같은 의미를 가진다.
- `?`: 패턴이 일치하지 않거나 1번만 일치할 때 사용한다. `{0,1}` 과 같은 의미를 가진다.

### 패턴 변경자

- 위 예시에서 사용되는 것들은 `패턴 구분자`라고 한다.
- 패턴 구분자 외 `패턴 변경자`를 통해 다양한 옵션을 넣을 수 있다.
- 패턴 변경자는 언어마다 사용하는 방법이 다르기 때문에 주의해야 한다.
  - 자바스크립트: `/패턴/{패턴 변경자}` ex) /[a-c]/i
  - Java: `(?{패턴 변경자})패턴` ex) (?i)[a-c]
- `i`: 패턴을 대소문자 구분 없이 검사한다.
  - `[a-z]`가 `[a-zA-Z]` 와 같은 의미가 된다.
- `s`: 메타 문자 `.`에 개행 문자를 포함시키도록 한다. 즉 개행도 임의의 한 문자로 취급하게 된다.
- `g`: `^` 와 `$` 가 의미하는 값이 문장 단위가 아니라, 전체 문서를 의미하도록 한다.
- `m`: 줄바꿈 문자가 있는 경우 여러 문장으로 취급한다.
- `x`: 공백 문자를 무시하게 한다.

## 실제 적용 - java

- Java에서 정규표현식은 `java.util.regex` 의 클래스들을 이용한다.
- 기본적으로 `Pattern` 클래스를 통해 정규표현식 패턴을 만들고, 그 결과를 `Matcher`를 통해 가져온다.

### `Pattern`

- `Pattern`은 기본적으로 `생성자`가 `private` 으로 선언되어 있기 때문에 일반적으로는 인스턴스를 만들 수 있다.
- `Pattern` 은 반드시 static 메소드를 통해서만 인스턴스를 만들 수 있다.
  - `Pattern.compile("pattern");`
- `Pattern`의 `matches` 메소드는 해당 패턴과 검사 문자열을 받아서 포함 여부를 판단한다.
  - 주의할 점은 `matches` 메소드는 실행 시 매번 `Pattern` 인스턴스를 생성한다는 것이다.
  - 즉, 여러 번 패턴 검사가 발생한다면, `matches` 가 아니라 `compile`을 통해 `Pattern` `인스턴스`를 생성하는 것이 좋다.
- Java에서는 `패턴 변경자`를 간단하게 적용할 수 있다.
  - `Pattern` 클래스 내부에 상수 값으로 이미 `flag`를 정의해놨기 때문에 `compile` 메소드 실행 시 해당 flag를 넘겨주면 된다.

### `Matcher`

- `Matcher` 는 `Pattern`을 통해 검사한 결과를 담아두고 있는 클래스다.
  - `Pattern`의 `matcher` 메소드를 통해 해당 패턴과 문자열에 대한 `Matcher`를 얻을 수 있다.
- `Pattern.matches` 메소드 역시 `Matcher`의 `matches` 메소드 결과를 리턴하는 것이다.
- `Matcher` 의 `find` 메소드를 통해 일치 여부를 확인할 수도 있다.
  - 주의할 점은 find 실행 시 해당 패턴이 일치하는 부분을 만날 때 까지 검사하다가, 만나게 되면 그 부분에서 멈춘다는 것이다.
  - 즉, find는 계속 호출할 경우 결과 값이 달라질 수 있다.
  - 예를 들어 해당 문자에서 한 번만 패턴이 일치하게 되면, 첫 find는 true 이지만, 그 이후 탐색하는 문자는 패턴이 일치하지 않기 때문에 false를 리턴한다.
- `Matcher` 의 `group` 메소드를 통해 그룹핑 형태로 매칭된 부분을 확인할 수도 있다.

### String

- Java의 String은 기본적으로 정규표현식을 검사할 수 있는 `matches` 메소드를 제공한다.
  - String의 matches는 결국 `Pattern.matches(regex, this);` 형태이기 때문에 `Pattern` 을 사용한다.

## 실제 적용 - kotlin

### Regex

- 코틀린에서는 Java의 `Pattern`과 동일한 `Regex`을 사용하면 된다.
- `Pattern` 과 다르게 `Regex`은 생성자가 존재한다.
  - Pattern.compile 과 동일하다고 생각하면 된다.
  - Regex(패턴, flag) 형태로 생성할 수 있으며, flag 값은 Enum으로 정의되어 있다.
- String 으로 정의된 패턴 문자열을 확장 함수 `toRegex`를 통해 간단하게 Regex 로 변환시킬 수 있다.

### MatchResult

- `Regex`의 패턴 매칭 결과물을 `MatchResult`을 통해 담아서 반환한다.
- `matchResult.value` 를 통해 매칭 결과물을 리턴할 수도 있다.
  - value 값은 Java의 Pattern.find 와 유사하게, 해당 패턴을 찾으면 그 부분에서 멈춘다.
  - 즉, value를 여러 번 호출할 수 있다. 다만, 그 전에 `matchResult.next()`를 먼저 선언해야 한다.
- `matchResult.groupValues`, `matchResult.groups[1]` 형태로 구룹핑 매칭 부분을 확인할 수도 있다.