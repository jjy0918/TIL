# 모두의 네트워크 5장 - 네트워크 계층 : 목적지에 데이터 전달하기

## 네트워크 계층의 역할

### 네트워크 간의 구조

- 네트워크 계층에서는 서로 다른 네트워크에 있는 목적지로 데이터를 전송한다.
- 네트워크 계층에서 데이터를 전송하려면 라우터라는 장비가 필요하다.
- 라우터는 해당 목적지까지 어떤 경로로 가는 것이 좋은지 알려준다.
- 라우터에는 라우팅 테이블이 존재하여, 경로 정보를 등록하고 관리한다.
- 목적지 주소를 식별하기 위해 IP주소를 이용한다.
- IP 주소는 어떤 네트워크의 컴퓨터인지를 구분할 수 있게 도와준다.

### IP란?

- IP = Internet Protocol
- IP란 네트워크에서 사용하는 프로토콜이다.
- 네트워크 계층에서 캡슐화할 때 IP 헤더를 붙인다.
- IP 헤더에는 버전, 헤더 길이, 서비스 유형, 전체 패킷 길이, ID(일련번호), 조각 상태, 조각의 위치, TTL, 프로토콜, 헤더 체크섬, `출발지 IP 주소`, `목적지 IP 주소`가 들어있다.
- IP 헤더를 통해 데이터를 정확하게 전달하기 위한 주소를 전달한다.
- IP 프로토콜을 사용하여 캡슐화된 것이 IP 패킷이다.

## IP 주소의 구조

### IP 주소란?

- 네트워크에서 사용하는 주소
- IP 주소는 ISP에게서 받을 수 있다.
- IP 버전에는 IPv4와 IPv6가 있다.
- IPv4는 32비트로 구성되어 있기 때문에 약 43억개를 만들 수 있고, 현재 주소로 사용된다.
- IPv6는 128비트로 구성되어 있고, IPv4 보다 매우매우 많은 수의 주소를 만들 수 있다.
- IPv4로 만들 수 있는 43억개로는 모든 주소를 표현할 수 없기 때문에 IPv6를 사용해야 한다.
- IP 주소는 공인 IP 주소와 사설 IP 주소가 있다.
- 공인 IP 주소는 ISP가 할당해준다.
- 사설 IP 주소는 회사나 가정의 랜에 있는 컴퓨터가 할당한다.
- ISP로부터 공인 IP 주소를 라우터가 할당 받고, 랜 안에 있는 컴퓨터들은 사설 IP를 할당 받는다.
  - 라우터의 DHCP 기능을 통해 자동으로 IP를 할당 받는다.
- IP주소는 8비트씩 나눠서 10진수로 읽고, 각 8비트를 옥텟이라고 부른다.
- IP 주소는 네트워크 ID와 호스트 ID로 나누어져있다.
  - 네트워크 ID는 어떤 네트워크인지 나타낸다.
  - 호스트 ID는 해당 네트워크의 어느 컴퓨터인지 나타낸다.

## IP 주소의 클래스 구조

### IP 주소 클래스란?

- IP 주소는 네트워크 크기를 클래스라는 개념을 통해 구분하고 있다.
- 클래스는 A~E 까지 존재한다.
  - A클래스 : 대규모 네트워크 주소
  - B클래스 : 중형 네트워크 주소
  - C클래스 : 소규모 네트워크 주소
  - D클래스 : 멀티캐스트 주소
  - E클래스 : 연구 및 특수용도 주소
- A클래스는 처음 8비트가 네트워크 ID이고, 다음 24비트가 호스트 ID이다.
  - A클래스의 1옥텟 범위는 00000001 ~ 01111111이다. 즉, 1~127이다.
  - A클래스에서 사설 IP주소 범위는 10.0.0.0 ~ 10.255.255.255이다.
- B클래스는 처음 16비트가 네트워크 ID이고, 다음 16비트가 호스트 ID이다.
  - B클래스의 1옥텟 범위는 10000000 ~ 10111111이다. 즉, 128 ~ 191이다.
  - B클래스에서 사설 IP주소 범위는 172.16.0.0 ~ 172.31.255.255 이다.
- C클래스는 처음 24비트가 네트워크 ID이고, 다음 8비트가 호스트 ID이다.
  - C클래스의 1옥텟 범위는 11000000 ~ 11011111이다. 즉, 192 ~ 223이다.
  - C클래스에서 사설 IP주소 범위는 192.168.0.0 ~ 192.168.255.255이다.

## 네트워크 주소와 브로드캐스트 주소의 구조

### 네트워크 주소와 브로드캐스트 주소란?

- IP 주소에는 네트워크 주소와 브로드캐스 주소가 있다.
- 네트워크 주소는 호스트ID가 0이다.
- 브로드캐스트 주소는 호스트 ID가 255이다.
- 네트워크 주소는 전체 네트워크에서 작은 네트워크를 식별하는 데 사용된다.
- 브로드캐스트 주소는 네트워크에 있는 컴퓨터나 장비 모두에게 한 번에 데이터를 전송하는데 사용된다.
- 그래서 네트워크 주소와 브로드캐스트 주소는 IP 주소로 설정하면 안된다.

## 서브넷의 구조

### 서브넷이란?

- 서브네팅이란 네트워크를 더 작은 네트워크 단위로 분할하는 것이다.
- 서브넷이란 서브네팅으로 분할된 네트워크이다.
- 서브넷은 호스트 ID를 서브넷 ID + 호스트 ID로 바꾸는 것이다.
- 즉, IP주소는 서브네팅을 통해 네트워크 ID + 서브넷 ID + 호스트 ID로 변경된다.

### 서브넷 마스크란?

- 서브넷 마스크 값을 통해 어느 부분이 네트워크 ID인지, 호스트 ID인지 판단할 수 있다.
- A클래스의 서브넷 마스크는 255.0.0.0
- B클래스의 서브넷 마스크는 255.255.0.0
- C클래스의 서브넷 마스크는 255.255.255.0
- 이러한 서브넷 마스크는 프리픽스 표기법으로 표현할 수 있다.(192.168.1.0/24)
- 서브네팅을 통해 호스트 ID에서 서브넷 ID를 분할하게 되면, 서브넷 마스크 값이 변경된다.

## 라우터의 구조

### 라우터란?

- 스위치로 구성된 네트워크는 모두 같은 네트워크에 속하게 된다.
- 라우터로 구성된 네트워크는 다른 네트워크로 분리된다.
- 서로 다른 네트워크로 데이터를 전송하기 위해 라우터의 IP 주소를 설정하게 되는데, 이것이 기본 게이트웨이다.

### 라우팅이란?

- 라우팅이란 경로 정보를 기반으로 현재의 네트워크에서 다른 네트워크로 최적의 경로를 통해 데이터를 전송하는 것.
- 이러한 경로 정보는 라우팅 테이블에 저장되어 있다.
- 라우팅 테이블은 수동으로 등록할 수 있고, 자동으로 등록할 수 있다.
- 자동으로 등록되는 방법은 라우터 간 경로 정보를 서로 교환하는 과정에서 등록된다.
- 라우터간 정보 교환을 위한 프로토콜이 라우팅 프로토콜이다.
- 라우팅 프로토콜에는 RIP, OSPF, BGP 등이 있다.
