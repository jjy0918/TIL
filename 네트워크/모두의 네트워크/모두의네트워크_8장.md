# 모두의 네트워크 8장 - 네트워크의 전체 흐름 살펴보기

## 렌 카드에서의 데이터 전달과 처리

### 네트워크의 구성

- 물리 계층 : 데이터를 전기 신호로 변환
- 데이터 링크 계층 : 랜에서 데이터를 송수신
- 네트워크 계층 : 다른 네트워크에 있는 목적지에 데이터 전달
- 전송 계층 : 목적지에 데이터를 정확하게 전달
- 응용(세션, 표현 포함) 계층 : 애플리케이션 등에서 사용하는 데이터 송수신

### 컴퓨터의 데이터가 전기 신호로 변환되는 과정

- 웹 브라우저 접속 과정

1. 웹 브라우저에서 http://www.naver.com를 입력
2. `응용 계층`에서는 `GET /index.html HTTp/1.1 ~` 등의 HTTP `메시지` 전송
3. `전송 계층`에서는 출발지의 포트 번화와 목적지의 포트 번호 등의 정보가 담긴 `TCP 헤더`를 붙여 `세그먼트`로 캡슐화
4. `네트워크 계층`에서는 `세그먼트`에 출발지 IP 주소와 목적지 IP 주소가 담긴 `IP 헤더`를 붙여 `패킷`으로 캡슐화
5. `데이터 링크 계층`에서는 `패킷`에 출발지와 목적지의 MAC 주소가 담긴 `이더넷 헤더`와 `트레일러`를 붙여 `프레임`으로 캡슐화
6. `물리 계층` 에서는 `프레임` 을 랜카드를 통해 전기 신호로 변환시켜 전송한다.

## 스위치와 라우터에서의 데이터 전달과 처리

### 스위치에서의 데이터 전달과 처리

- 스위치에서는 데이터링크 계층에서 데이터를 전기 신호로 변환하여 라우터로 전송한다.

### 라우터에서의 데이터 전달과 처리

1.  전기 신호가 라우터에 도달한다.
2.  `물리 계층`에서 전기 신호를 데이터로 변화시킨다.
3.  `데이터 링크 계층`에서 `이더넷 헤더`에 있는 `목적지의 라우터 MAC 주소`를 확인한다.
4.  목적지의 라우터 MAC 주소가 일치하는 경우 역캡슐화를 하여 네트워크 계층으로 패킷을 전달한다.
5.  `네트워크 계층` 에서 라우터는 `IP 헤더`를 확인하여 목적지 주소와 라우팅 테이블을 비교한다.
6.  `라우팅` 과정을 통해 경로를 찾게 되면, ~~`IP 헤더`~~ `MAC 주소에`에 자신의 ~~IP~~ MAC주소를 입력한 후 다시 캡슐화를 진행한다.
7.  물리 계층까지 캡슐화 후 목적지 라우터로 전기 신호를 보낸다.
8.  목적지 라우터에 도달한 경우, 해당 라우터는 출발지의 라우터 주소를 원래 주소로 변경한 후 목적지에 전송한다.

> https://www.quora.com/If-a-packet-moves-from-network-A-to-network-B-does-network-B-always-removes-the-IP-header-added-by-network-A-and-adds-its-own-IP-header
