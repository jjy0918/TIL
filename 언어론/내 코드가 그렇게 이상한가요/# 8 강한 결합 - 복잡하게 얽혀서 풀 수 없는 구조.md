# 8 강한 결합 - 복잡하게 얽혀서 풀 수 없는 구조

- `결합도` 란 모듈 사이의 의존도를 나타내는 지표라고 할 수 있다.
- 어떤 클래스가 다른 클래스에 많이 의존하고 있는 구조를 `강한 결합` 이라고 한다.
  - 강한 결합 코드는 이해하기도 힘들고, 변경하기도 힘들다.
- 결합도가 낮은 구조를 `느슨한 결합` 이라고 부른다.
  - 느슨한 결합은 코드 변경이 쉬워진다.

## 8.1 결합도와 책무

- 소프트웨어 설계에서 책무란 어떤 관심사를 정상적으로 작동하게 제어해야 하는 책임라고 할 수 있다.
  - 간단하게 어떤 클래스가 가져야 하는 책임을 말한다.
- 책무를 고려하고 클래스를 설계하게 되면 여러 안좋은 부분이 있다.
  - 변경이 발생했을 때 예상하지 못한 버그가 발생할 수 있다.
  - 하나의 클래스가 여러 책임을 가지고 있기 때문에 로직의 위치에 일관성이 없어진다.

### 단일 책임 원칙

- 단일 책임 원칙이란 클래스가 담당하는 책임을 하나로 제한해야 한다는 것을 말한다.
- 소프트웨어에서 책임이란 자신의 관심사와 관련해서 정상적으로 동작하도록 제어하는 것이다.
- 단일 책임 원칙 위반한다는 것은 하나의 클래스가 여러 책임을 가지고 있다는 것이고, 하나의 변경이 일어나면 다른 책임에도 변경이 발생할 수 있다는 것이다.
- 책임이 하나가 되게 클래스 설계하는 것이 중요하다.
  - 책임을 나누어 관심사에 따라 분리하게 되면, 느슨한 결합이 된다.
- 비슷한 로직을 가지고 있더라도, 책임이 다르다면 분리하는 것이 맞는 방향이다.
  - 비슷한 로직이라고 무조건 통합시키면 안된다.
    - DRY(Don't Repeat Yourself)은 무조건 통일하는 것이 아니라 개념이 다르면 중복을 허용한다.
  - 책임이 다르기 때문에 변경이 발생했을 때 해당 책임을 가진 부분만 변화되어야 한다.

## 8.2 다양한 강한 결합 사례와 대처 방법

### 8.2.1 상속과 관련된 강한 결합

- 상속은 주의해서 다루지 않으면, 곧바로 강한 결합 구조를 유발한다.
- 상속의 경우 super 클래스에 강하게 의존하고 있기 떄문에 super 클래스가 변경될 경우 자식 클래스가 의도하지 않은 동작을 하게 만든다.
- `상속 보다는 컴포지션`
  - 슈퍼 클래스 의존으로 인한 강한 결합을 피하려면, 상속보다 컴포지션을 사용하는 것이 좋다.
  - 컴포지션이란 클래스 코드를 인스턴스 변수로 갖고 사용하는 것을 말한다.
  
### 8.2.2 인스턴스 변수별로 클래스 분할이 가능한 로직

- 인스턴스 변수별로 클래스 분할이 가능하다면, 클래스 분할을 하는 것이 좋다.

### 8.2.3 특별한 이유 없이 public 사용하지 않기

- public을 붙이게 되면 강한 결합 구조가 되버리기 때문에 주의해야 한다.
- public으로 만들면 관계를 맺지 않았으면 하는 클래스끼리도 결합되어 영향 범위가 확대된다.
- 클래스는 기본적으로 package private 으로 만들고 정말 특별히 공개되어야 하는 경우에만 public으로 만들자.

### 8.2.4 private 메서드가 너무 많다는 것은 책임이 너무 많다는 것.

- private 메서드가 많다는 것은 책임이 많다는 것일 수 있기 때문에 다른 클래스로 분리하는 것이 좋다.

### 8.2.5 높은 응집도를 오해해서 생기는 강한 결합

- 관련이 깊은 데이터와 논리를 한곳에 모은 구조를 응집도가 높은 구조라고 한다.
- 응집도가 높은 것과 강한 결합은 다른 것이다.
  - 높은 응집도를 잘못 이해하여 강한 결합이 발생하는 경우가 있다.

### 8.2.9 갓 클래스

- 갓 클래스란 하나의 클래스 내부에 수천에서 수만 줄의 로직을 담고 있으며, 수많은 책임을 담당하는 로직이 난잡하게 섞여 있는 클래스를 말한다.
- 갓 클래스는 개발자의 시간을 빼앗고, 개발자를 피폐하게 만든다.
  - 영향 범위 파악이 어렵고, 수정하기가 힘들다.