# 17장 경계 선긋기

- 소프트웨어 아키텍처는 선을 긋는 기술이다.
- 선은 경계를 의미하며, 경계는 소프트웨어 요소를 서로 분리하여 경계 너머의 요소는 서로를 알지 못하도록 막는다.
- 선은 프로젝트 초기에 그어지기도 하지만, 매우 나중에 그어지기도 한다.
- 소프트웨어에서 효율이 떨어지는 원인은 결합이다.
- 특히 너무 일찍 내려진 결정에 따른 결합이 치명적이다.
- 좋은 아키텍처란 결정이 부수적이며, 결정을 연기할 수록 좋은 아키텍처다.
  - 좋은 아키텍처는 결정에 의존하지 않고, 결정을 가능한 한 최후에 내릴 수 있게 해준다.

## 어떻게 선을 그을까? 그리고 언제 그을까?

- 관련이 있는 것과 없는 것 사이에 선을 긋는다.
  - GUI는 업무 규칙과 관련 없기 때문에 둘 사이에는 선이 있어야 한다.
  - 데이터베이스와 GUI는 관련 없기 때문에 둘 사이에는 선이 있어야 한다.
  - 데이터베이스와 업무 규칙은 관련 없기 때문에 둘 사이에는 선이 있어야 한다.
- 일반적으로 데이터베이스와 업무 규칙은 연관이 있는 부분이기 때문에 선이 있어서는 안된다고 한다.
- 가장 잘 구현되어 있는 상태는 `Businness Rules`(업무 규칙)가 `Database Interface`를 가지고 있으며, `Database Access`가 `Database Interface`를 구현한 상태로 사용하는 것이다.
- 인터페이스를 이용하여 `Businness Rules`와 `Database Access`는 분리된 상태가 된다.
- `Businness Rules`는 인터페이스를 가지고 소통하기 떄문에 `Database Access`에 대해 모르지만, `Database Access`는 `Businness Rules`가 필요한 데이터를 줘야 하기 때문에 알고 있는 상태가 된다.
  - 즉, 단방향으로 구성되게 된다.
- `Businness Rules`는 어떠한 데이터베이스라고 하더라도 사용할 수 있게 된다.

```
Businness Rules -> Database Interface (경계) <- Database Access <-> Database
```

## 입력과 출력

- 고객과 개발자는 시스템이 무엇인지 서로 다르게 이해한다.
- 흔히들 GUI(입력, 출력)이 시스템이라 착각하지만, 시스템이란 그 내부에서 동작하는 업무 규칙이다.
- 입력과 출력은 중요하지 않다.
- 결국은 인터페이스(입력, 출력)을 조작하는 모델(데이터 구조와 함수로 구성된 정교한 집합)이 존재하는 것이고, 그것이 핵심이라는 것이다.
- 모델은 인터페이스가 전혀 필요하지 않다.
- 즉, GUI와 BusinessRules 컴포넌트는 경계선에 의해 분할된다는 것이고, GUI가 BusinessRules을 신경쓰는 형태가 된다.
  - GUI -> BusinessRules
- GUI는 다른 종료의 인터페이스로 얼마든지 교체할 수 있고, BusinessRules는 전혀 개의치 않는다.

## 플러그인 아키텍처

- GUI와 업무 규칙과 같은 관계를 보면, 일종의 패턴이 만들어진다.
- 이러한 패턴은 서드파티 플러그인을 사용할 수 있게 만들어준다.
- 핵심 기능인 업무 규칙(BusinessRules)은 변하지 않으며, 변경 가능한 GUI, DB 는 플러그인 형태로 새로운 컴포넌트로 손쉽게 교체할 수 있도록 해야 한다.
- 핵심 업무 규칙은 선택적이거나 다양한 형태로 구현될 수 있는 컴포넌트로부터 분리되어야 한다.

## 플러그인에 대한 논의

- 우리는 특정 모듈이 나머지 모듈에 영향받지 않기를 바란다.
- 즉, 데이터베이스 스키마가 변경되더라도 업무 규칙은 꺠지지 않기를 바란다.
- 시스템을 플러그인 아키텍처로 배치함으로써 변경이 전화될 수 없는 방화벽을 생성하는 것이다.
- 경계는 변경의 축이 있는 지점에 그어진다.
- 경계의 한쪽에 위치한 컴포넌트는 경계 반대편의 컴포넌트와는 다른 속도로와 이유로 변경된다.
- 단일 책임 원칙은 어디에 경계를 그어이ㅑ 할지를 알려준다.

## 결론

- 소프트웨어 아키텍처에서 경계선을 그리려면 먼저 시스템을 컴포넌트 단위로 분할해야 한다.
- 일부 컴포넌트는 핵심 업무 규칙에 해당하며, 나머지 컴포넌트는 플러그인이 된다.
- 컴포넌트 사이의 화살표가 특정 방향(핵심 업무 <- 플러그인) 형태로 소스를 배치해야 한다.
- 의존성 화살표는 저수준 세부사항에서 고수준 추상화를 향하도록 배치된다.
- 이러한 방식은 의존성 역전 원칙과 안정된 추상화 원칙을 응용한 것이다.
