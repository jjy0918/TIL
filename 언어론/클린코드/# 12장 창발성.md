# 12장 창발성

## 창발적 설계로 깔끔한 코드를 구현하자

- 켄트 백이 제시한 `단순한 설계` 규칙 네 가지는 소프트웨어의 설계 품질을 크게 높여준다.
  - 네 가지 규칙을 따르면 설계는 단순해진다.
  - 규칙을 따르면 구조 설계 파악이 쉬워지고, SRP나 DIP 와 같은 원식 적용이 쉬워진다.

1. 모든 테스트를 실행한다.
2. 중복을 없앤다.
3. 프로그래머 의도를 표현한다.
4. 클래스와 메서드 수를 최소로 줄인다.

## 단순한 설계 규칙 1: 모든 테스트를 실행하라.

- 설계는 의도한 대로 돌아가는 시스템을 내놓아야 한다.
- 시스템이 의도한 대로 돌아가는지 검증할 방법이 없다면, 노력에 대한 가치는 인정받기 힘들다.
- 테스트를 철저히 거쳐 모든 테스트 케이스를 항상 통과하는 시스템은 `테스트가 가능한 시스템`이다.
  - 테스트가 불가능한 시스템은 검증이 불가능하다.
  - 검증이 불가능한 시스템은 절대 출시하면 안 된다.
- 테스트가 가능한 시스템을 만들려고 애쓰면 설계 품질이 높아진다.
  - 크기가 작고 목적 하나만 수행하는 클래스가 나온다.
  - SRP를 준수하는 클래스는 테스트가 쉽다.
  - 테스트 케이스가 많을수록 개잘자는 테스트가 쉽게 코드를 작성한다.
- 결합도가 높으면 테스트 케이스를 작성하기 어렵다. 즉, 테스트 케이스를 많이 작성할수록 개발자는 DIP와 같은 원직을 적용하는 등 결합도를 낮추게 된다.
- 테스트 케이스를 만들고 계속 돌리라는 것은, 간단한 규칙이지만 낮은 결합도와 높은 응집력에 대한 목표를 저절로 달성하게 해준다.

## 단순한 설계 규칙 2~4: 리펙터링

- 테스트 케이스를 모두 작성했다면, 코드를 점진적으로 리펙토링하면 된다.
- 코드 추가 시 설계 품질을 낮추는지 조감한 후 문제가 된다면 제거하면 된다.
  - 코드가 제거되어도 테스트 코드가 있기 때문에 시스템이 꺠질 걱정할 필요가 없다.
- 리펙터링 단계에서는 설계 품질을 높이는 기법 무엇이든 적용해도 된다.
- 이 단계에서는 단순하 설계 규칙 중 나머지 3개를 적용하는 단계다.

## 중복을 없애라.

- 우수한 설계에서 중복은 커다란 적이다.
  - 중복은 추가 작업, 추가 위험, 불필요한 복잡도를 뜻한다.
- 중복은 여러 가지 형태로 표출된다.
  - 똑같은 코드
  - 구현 중복
- 중복을 제거하면서 메서드의 가시성을 높일 수 있고, 시스템의 복잡도를 줄일 수 있다.
  - TEMPLATE METHOD 패턴은 고차원 중복을 제거할 복적으로 자주 사용된다.

## 표현하라

- 자신이 이해하는 코드를 짜기는 쉽지만 다른 사람이 유지보수를 한다면, 깊이 이해할 가능성은 희박하다.
- 소프트웨어의 비용 중 대다수는 장기적인 유지보수에 들어간다.
- 코드를 변경하면서 버그의 싹을 심지 않으려면 유지보수 개발자가 시스템을 제대로 이해해야 한다.
- 시스템이 복잡해지면서 유지보수 개발자가 시스템을 이해하느라 보내는 시간이 늘고 코드를 오해할 가능성도 점점 커진다.
- 그러므로 가장 중요한 것은 `개발자의 의도`를 분명하게 표현해야 한다는 것이다.
  - 개발자가 코드를 명백하게 짤수록 다른 사람이 그 코드를 이해하기 쉬워진다.
- 첫째, `좋은 이름`을 선택해야 한다.
  - 이름과 기능이 완전히 딴판인 클래스나 함수로 유지보수 담당자를 놀라게 해서는 안 된다.
- 둘째, 함수와 클래스 크기를 가능한 줄인다.
  - 작은 클래스와 작은 함수는 이름 짓기도 쉽고, 구현하기도 쉬우며 이해하기도 쉽다.
- 셋째, 표준 명칭을 사용한다.
  - 디자인 패턴 등을 사용할 경우 클래스 이름에 패턴 이름을 넣는다면 이해하기가 더욱 쉽다.
- 넷째, 단위 테스트 케이스를 꼼꼼히 작성한다.
- 나중에 코드를 읽을 사람은 바로 자신일 가능성이 높다는 사실을 명시해라.
  - 자신의 작품에 더 시간을 투자하고 더 나은 이름을 선택하고 주의를 기울여라.

## 클래스와 메서드 수를 최소로 줄여라

- 중복을 제거하고, 의도를 표현하고, SRP를 준수한다는 기본적은 개념도 극단으로 치달으면 득보다 실이 많아진다.
- 때로는 무의미하고 독단적인 정책 탓에 클래스 수와 메서드 수가 늘어나기도 한다.
  - 클래스마다 무조건 인터페이스를 생성하라는 요구
  - 자료 클래스와 동작 클래스는 무조건 분리해야 한다고 주장.
  - 가능한 독단적인 견해는 멀리하고 실용적인 방식을 택하라.
- 목표는 함수와 클래스 크기를 작게 유지하면서 동시에 시스템 크기도 작게 유지하는 것이다.
- 하지만, 이 규칙은 우선순위가 가장 낮다는 것을 명심하라.